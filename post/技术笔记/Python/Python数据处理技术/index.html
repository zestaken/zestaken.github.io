<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <head>
    <link href="/styles/main.css" rel="stylesheet" type="text/css"/>

    <meta charset="UTF-8">
    
    <title>Python数据处理技术 - ZestJourney</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/bootstrap/4.6.1/css/bootstrap.min.css">
    <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/bootstrap/4.6.1/js/bootstrap.min.js"></script>

<script src="https://npm.elemecdn.com/@waline/client@v2/dist/waline.js"></script>
<link
  rel="stylesheet"
  href="https://npm.elemecdn.com/@waline/client@v2/dist/waline.css"
/>
<meta name="generator" content="Hexo 5.4.2"></head>

</head>

<body>
    


        <div>
            <div class="container-fluid position-relative">
                <nav class="navbar navbar-expand-lg navbar-dark  text-white bg-transparent">
                    <div class="container">
                        
                        <a class="navbar-brand" href="/">💖我们的秘密基地💖</a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText"
                            aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarText">
                            <ul class="navbar-nav mr-auto">
                            </ul>
                            <span class="navbar-text">
                                💕愿你三冬暖，愿你春不寒🍂
                            </span>
                        </div>
                    </div>
                </nav>
                <section class="lover-background"
                    style="background-image: url(/img/banner.jpg)">
                </section>
                <section
                    class="container lover-container d-flex flex-column align-content-center justify-content-center">
                    <div class="row align-items-center pb-5 lover">
                        <div class="col">
                            <div class="d-flex flex-column">
                                <img class="mx-auto avatar-img rounded-circle"
                                    src="/img/zestaken.jpg" alt="">
                                <h4 class="mx-auto text-white pt-2">  
                                    zestaken
                                </h4>
                            </div>
                        </div>
                        <div class="col">
                            <div class="d-flex justify-content-center">
                                <div class="heart"></div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="d-flex flex-column">
                                <img class="mx-auto avatar-img rounded-circle"
                                    src="/img/zinny.jpg" alt="">
                                <h4 class="mx-auto text-white pt-2">
                                    zinny
                                </h4>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="main-hero-waves-area waves-area">
                    <svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                        viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
                        <defs>
                            <path id="gentle-wave"
                                d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z">
                            </path>
                        </defs>
                        <g class="parallax">
                            <use xlink:href="#gentle-wave" x="48" y="0"></use>
                            <use xlink:href="#gentle-wave" x="48" y="3"></use>
                            <use xlink:href="#gentle-wave" x="48" y="5"></use>
                            <use xlink:href="#gentle-wave" x="48" y="7"></use>
                        </g>
                    </svg>
                </section>
            </div>

            <div id="Pjax">

  <div class="list-content mx-auto mt-5">
      <div id="article" class="list-top">
          <h5 class="list-text"> Python数据处理技术
          </h5>
          <article>
              <article>
                <h1 id="合并数据集"><a class="markdownIt-Anchor" href="#合并数据集"></a> 合并数据集</h1>
<h2 id="索引上的合并"><a class="markdownIt-Anchor" href="#索引上的合并"></a> 索引上的合并</h2>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">import pandas as pd
import numpy as np</code></pre>
<ul>
<li>连接的方法：
<ul>
<li>通过列与索引合并</li>
<li>通过索引和索引合并</li>
<li>复合索引和多个列来合并</li>
</ul>
</li>
</ul>
<h3 id="生成索引的两种方式"><a class="markdownIt-Anchor" href="#生成索引的两种方式"></a> 生成索引的两种方式</h3>
<ul>
<li>构建数据表（DataFrame）自动生成索引：使用pandas库的DataFrame对象，花括号中以键值对的形式，给出列名和值，索引会自动按序生成</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">left1 &#x3D; pd.DataFrame(&#123;&#39;key&#39;: [&#39;a&#39;, &#39;b&#39;, &#39;a&#39;,&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], &#39;value&#39;: range(6)&#125;)
left1</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>c</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>可以通过设置index参数来指定索引创造DataFrame对象</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">right1 &#x3D; pd.DataFrame(&#123;&#39;group_val&#39;:[3.5, 7]&#125;, index&#x3D;[&#39;a&#39;, &#39;b&#39;])
right1</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group_val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>3.5</td>
    </tr>
    <tr>
      <th>b</th>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="连接的模式"><a class="markdownIt-Anchor" href="#连接的模式"></a> 连接的模式</h3>
<ul>
<li>根据索引和列来合并两个表，使用<code>merge()</code>函数，参数依次为：左表（DataFrame对象)，右表，left_on参数指定左表的某一列用于合并，right_index参数指定使用右表的索引来合并（因为索引是唯一的，所以直接设置True或false即可），同理也有right_on和left_index参数，只是left_on和left_index参数不能同时使用</li>
<li>内连接：<code>merge()</code>函数的默认方式，求两张表的交集</li>
<li>外连接：求两种表的并集，如果有的元素，一个表有而另一个表没有，则在代表另一个表值的列使用<code>NaN</code>填充</li>
</ul>
<h4 id="内连接"><a class="markdownIt-Anchor" href="#内连接"></a> 内连接</h4>
<ul>
<li>内连接的使用示例：</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">merge1 &#x3D; pd.merge(left1, right1, left_on&#x3D;&#39;key&#39;, right_index&#x3D;True)
merge1</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>value</th>
      <th>group_val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>3</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b</td>
      <td>4</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="外连接"><a class="markdownIt-Anchor" href="#外连接"></a> 外连接</h4>
<ul>
<li>外连接：求两张表的并集,<code>merge()</code>函数需要设置<code>how</code>参数来启动外连接模式</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">merge2 &#x3D; pd.merge(left1, right1, left_on&#x3D;&#39;key&#39;, right_index&#x3D;True,how&#x3D;&#39;outer&#39;)
merge2</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>value</th>
      <th>group_val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>3</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b</td>
      <td>4</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>c</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="通过复合索引合并"><a class="markdownIt-Anchor" href="#通过复合索引合并"></a> 通过复合索引合并</h4>
<ul>
<li>
<p>通过复合索引和两个列来合并</p>
<ul>
<li>通过自动生成索引创建左表</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">lefth &#x3D; pd.DataFrame(&#123;&#39;key1&#39;: [&#39;Ohio&#39;, &#39;Ohio&#39;, &#39;Ohio&#39;, &#39;Nevada&#39;, &#39;Nevada&#39;], &#39;key2&#39;: [2000, 2001, 2002, 2001, 2002], 
                      &#39;data&#39;: np.arange(5a)&#125;)
lefth</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ohio</td>
      <td>2001</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nevada</td>
      <td>2001</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nevada</td>
      <td>2002</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>​	指定两个列作为复合索引</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">righth &#x3D; pd.DataFrame(np.arange(6*2).reshape(6, 2), index &#x3D; [[&#39;Nevada&#39;, &#39;Nevada&#39;, &#39;Ohio&#39;, &#39;Ohio&#39;, &#39;Ohio&#39;, &#39;Ohio&#39;], 
                                                            [2001, 2000, 2000, 2000, 2001, 2002]],
                     columns&#x3D;[&#39;event1&#39;, &#39;event2&#39;])
righth</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>event1</th>
      <th>event2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Nevada</th>
      <th>2001</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Ohio</th>
      <th>2000</th>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>使用<code>merge()</code>函数内连接两个表</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">merge3 &#x3D; pd.merge(lefth, righth, left_on&#x3D;[&#39;key1&#39;, &#39;key2&#39;], right_index&#x3D;True)
merge3</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>data</th>
      <th>event1</th>
      <th>event2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ohio</td>
      <td>2001</td>
      <td>1</td>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>2</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nevada</td>
      <td>2001</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>结果分析：因为Nevada 2000这个组合在左表中存在而在右表中不存在，所以在合并表中并没有出现</li>
</ul>
<hr />
<ul>
<li>让两个表都使用索引来合并</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">left2 &#x3D; pd.DataFrame([[1., 2.,], [3., 4.], [5., 6.]], index&#x3D;[&#39;a&#39;, &#39;c&#39;, &#39;e&#39;], 
                     columns&#x3D;[&#39;Ohio&#39;, &#39;Nevada&#39;])
left2</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ohio</th>
      <th>Nevada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">right2 &#x3D; pd.DataFrame([[7., 8.], [9., 10.], [11., 12.], [13., 14.]], index&#x3D;[&#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;], 
                      columns&#x3D;[&#39;Missouri&#39;, &#39;Alabama&#39;])
right2</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missouri</th>
      <th>Alabama</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>11.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>13.0</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>
</div>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">merge4 &#x3D; pd.merge(left2, right2, left_index &#x3D; True, right_index &#x3D; True)
merge4</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ohio</th>
      <th>Nevada</th>
      <th>Missouri</th>
      <th>Alabama</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>c</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>5.0</td>
      <td>6.0</td>
      <td>13.0</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>
</div>
<hr />
<h4 id="通过join函数连接"><a class="markdownIt-Anchor" href="#通过join函数连接"></a> 通过join函数连接</h4>
<ul>
<li>通过<code>join</code>函数来合并：
<ul>
<li>有主表：左表-&gt;所以默认左连接（左表的都保留，右表和左表相同索引的才保留，右表不存在的用<code>NaN</code>填充）</li>
<li>同样可以通过<code>how</code>参数来设置连接方式</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">merge5 &#x3D; left2.join(right2)
merge5</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ohio</th>
      <th>Nevada</th>
      <th>Missouri</th>
      <th>Alabama</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>5.0</td>
      <td>6.0</td>
      <td>13.0</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>可以通过<code>on</code>参数来使用左表的特定列来合并</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">merge6 &#x3D; lefth.join(righth, on&#x3D;[&#39;key1&#39;, &#39;key2&#39;])
merge6</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>data</th>
      <th>event1</th>
      <th>event2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>0</td>
      <td>6.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ohio</td>
      <td>2001</td>
      <td>1</td>
      <td>8.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>2</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nevada</td>
      <td>2001</td>
      <td>3</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nevada</td>
      <td>2002</td>
      <td>4</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
<hr />
<h4 id="轴向连接"><a class="markdownIt-Anchor" href="#轴向连接"></a> 轴向连接</h4>
<ul>
<li>轴向连接：将多个同样的表合并为一个表（增加行数）concatennation
<ul>
<li>使用Numpy的函数<code>concatenate()</code></li>
</ul>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">arr &#x3D; np.arange(12).reshape(3, 4)
arr</code></pre>
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</code></pre>
<ul>
<li>使用<code>concatenate()</code>函数横向或纵向合并两个arr</li>
<li>通过<code>axis</code>参数来控制合并的方向</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">arr1 &#x3D; np.concatenate([arr, arr], axis&#x3D;1) # 横向合并
arr1</code></pre>
<pre><code>array([[ 0,  1,  2,  3,  0,  1,  2,  3],
       [ 4,  5,  6,  7,  4,  5,  6,  7],
       [ 8,  9, 10, 11,  8,  9, 10, 11]])
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">arr2 &#x3D; np.concatenate([arr, arr], axis&#x3D;0) # 纵向合并
arr2</code></pre>
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</code></pre>
<h3 id="合并重叠数据"><a class="markdownIt-Anchor" href="#合并重叠数据"></a> 合并重叠数据</h3>
<ul>
<li>创建两个列一致，部分数据一致的一位序列Series</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">a &#x3D; pd.Series([np.nan, 2.5, np.nan, 3.5, 4.5, np.nan], index&#x3D;[&#39;f&#39;, &#39;e&#39;, &#39;d&#39;, &#39;c&#39;, &#39;b&#39;, &#39;a&#39;])
a</code></pre>
<pre><code>f    NaN
e    2.5
d    NaN
c    3.5
b    4.5
a    NaN
dtype: float64
</code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">b &#x3D; pd.Series(np.arange(len(a), dtype&#x3D;np.float64), index&#x3D;[&#39;f&#39;, &#39;e&#39;, &#39;d&#39;, &#39;c&#39;, &#39;b&#39;, &#39;a&#39;])
b[-1] &#x3D; np.nan #-1下标指代序列的最后一位元素
b</code></pre>
<pre><code>f    0.0
e    1.0
d    2.0
c    3.0
b    4.0
a    NaN
dtype: float64
</code></pre>
<ul>
<li>合并两个数据集，以a表为标准，a表中存在的数据保持原样，a表中不存在（NaN）的数据从b中合并过来</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">c &#x3D; np.where(pd.isnull(a), b, a) # 当a为空时取b的值，否则取a的值
c</code></pre>
<pre><code>array([0. , 2.5, 2. , 3.5, 4.5, nan])
</code></pre>
<h1 id="数据转换"><a class="markdownIt-Anchor" href="#数据转换"></a> 数据转换</h1>
<h2 id="移除重复数据"><a class="markdownIt-Anchor" href="#移除重复数据"></a> 移除重复数据</h2>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data &#x3D; pd.DataFrame(&#123;&#39;k1&#39;:[&#39;one&#39;]*3+[&#39;two&#39;]*4, &#39;k2&#39;:[1,1,2,3,3,4,4]&#125;)
data</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>two</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>使用DataFrame对象的<code>duplicated()</code>函数检测是否重复行（是为true），返回一个Series对象</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">dup &#x3D; data.duplicated()
dup</code></pre>
<pre><code>0    False
1     True
2    False
3    False
4     True
5    False
6     True
dtype: bool
</code></pre>
<ul>
<li><code>drop_duplicates()</code>方法去重, 可以指定用于比较是否相同的某一(或多）列（不一定完全重复),默认保留index最小的行，可以通过设置<code>keep='last'</code>参数保留index最大的数据</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">nodup &#x3D; data.drop_duplicates(keep&#x3D;&#39;last&#39;)
nodup</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>two</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>给data添加一列</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data[&#39;v1&#39;] &#x3D; range(7)
data</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>v1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>one</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>two</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>可以指定通过具体哪些列来判断是否重复</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">nodup2 &#x3D; data.drop_duplicates([&#39;k1&#39;, &#39;k2&#39;], keep&#x3D;&#39;last&#39;)
nodup2</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>v1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>one</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>two</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="数据替换"><a class="markdownIt-Anchor" href="#数据替换"></a> 数据替换</h2>
<ul>
<li>定义一个series</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data &#x3D; pd.Series([1., -999, 2., -1000, 3.])
data</code></pre>
<pre><code>0       1.0
1    -999.0
2       2.0
3   -1000.0
4       3.0
dtype: float64
</code></pre>
<ul>
<li>通过<code>replace()</code>方法将-999替换为NaN</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data.replace(-999, np.nan)</code></pre>
<pre><code>0       1.0
1       NaN
2       2.0
3   -1000.0
4       3.0
dtype: float64
</code></pre>
<ul>
<li>可以同时替换多个值，例如将-999和-1000同时替换为NaN</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data.replace([-999, -1000], np.nan)</code></pre>
<pre><code>0    1.0
1    NaN
2    2.0
3    NaN
4    3.0
dtype: float64
</code></pre>
<ul>
<li>可以实现不同的值对应替换替换为不同的值,例如将-999替换为NaN，-1000替换为0</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data.replace([-999, -1000], [np.nan, 0])</code></pre>
<pre><code>0    1.0
1    NaN
2    2.0
3    0.0
4    3.0
dtype: float64
</code></pre>
<h2 id="检测异常值"><a class="markdownIt-Anchor" href="#检测异常值"></a> 检测异常值</h2>
<ul>
<li>创建一个含有正态分布数据的DataFrame, 通过DataFrame对象的<code>describe()</code>方法来获取统计特征值</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data &#x3D; pd.DataFrame(np.random.randn(1000, 4))
data.describe()</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.013166</td>
      <td>-0.000481</td>
      <td>-0.030189</td>
      <td>-0.009518</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.976413</td>
      <td>1.016713</td>
      <td>0.997048</td>
      <td>1.008174</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-3.016676</td>
      <td>-3.162513</td>
      <td>-3.282324</td>
      <td>-3.535175</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.649836</td>
      <td>-0.688303</td>
      <td>-0.703782</td>
      <td>-0.698088</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.004212</td>
      <td>0.011474</td>
      <td>0.009120</td>
      <td>-0.001872</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.695183</td>
      <td>0.679623</td>
      <td>0.639148</td>
      <td>0.649286</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.407439</td>
      <td>4.139005</td>
      <td>2.763371</td>
      <td>3.721676</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>选出含有大于3或者小于-3的值的行</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data[(np.abs(data) &gt;3).any(1)]</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>38</th>
      <td>-0.795664</td>
      <td>-0.330065</td>
      <td>-3.016717</td>
      <td>2.120561</td>
    </tr>
    <tr>
      <th>50</th>
      <td>-0.629000</td>
      <td>0.860827</td>
      <td>-0.125433</td>
      <td>-3.535175</td>
    </tr>
    <tr>
      <th>79</th>
      <td>-0.544495</td>
      <td>-1.288971</td>
      <td>-3.029938</td>
      <td>0.279044</td>
    </tr>
    <tr>
      <th>113</th>
      <td>-3.016676</td>
      <td>0.869205</td>
      <td>-1.010988</td>
      <td>-0.573853</td>
    </tr>
    <tr>
      <th>254</th>
      <td>4.407439</td>
      <td>1.526187</td>
      <td>-1.255663</td>
      <td>-0.069301</td>
    </tr>
    <tr>
      <th>276</th>
      <td>-0.646509</td>
      <td>-2.390895</td>
      <td>1.456119</td>
      <td>-3.337455</td>
    </tr>
    <tr>
      <th>308</th>
      <td>1.139149</td>
      <td>4.139005</td>
      <td>-1.131373</td>
      <td>0.575723</td>
    </tr>
    <tr>
      <th>493</th>
      <td>3.189728</td>
      <td>0.442730</td>
      <td>-1.561426</td>
      <td>0.402213</td>
    </tr>
    <tr>
      <th>509</th>
      <td>0.267529</td>
      <td>-3.162513</td>
      <td>1.107551</td>
      <td>-1.028598</td>
    </tr>
    <tr>
      <th>535</th>
      <td>-0.679389</td>
      <td>3.022345</td>
      <td>-0.983833</td>
      <td>0.965855</td>
    </tr>
    <tr>
      <th>758</th>
      <td>-0.182049</td>
      <td>0.552248</td>
      <td>1.448889</td>
      <td>3.721676</td>
    </tr>
    <tr>
      <th>841</th>
      <td>1.724263</td>
      <td>1.075039</td>
      <td>-3.282324</td>
      <td>1.537926</td>
    </tr>
    <tr>
      <th>895</th>
      <td>-1.313186</td>
      <td>3.063947</td>
      <td>0.154505</td>
      <td>1.813358</td>
    </tr>
    <tr>
      <th>931</th>
      <td>1.180028</td>
      <td>3.300766</td>
      <td>-0.809880</td>
      <td>-1.084533</td>
    </tr>
    <tr>
      <th>933</th>
      <td>-0.037565</td>
      <td>0.175728</td>
      <td>-3.255756</td>
      <td>1.189677</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>将选出的行的异常值用3或者-3替换</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data[np.abs(data) &gt; 3] &#x3D; np.sign(data) * 3
data.describe()</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.011585</td>
      <td>-0.001845</td>
      <td>-0.029604</td>
      <td>-0.009367</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.970417</td>
      <td>1.011010</td>
      <td>0.995229</td>
      <td>1.002956</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-3.000000</td>
      <td>-3.000000</td>
      <td>-3.000000</td>
      <td>-3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.649836</td>
      <td>-0.688303</td>
      <td>-0.703782</td>
      <td>-0.698088</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.004212</td>
      <td>0.011474</td>
      <td>0.009120</td>
      <td>-0.001872</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.695183</td>
      <td>0.679623</td>
      <td>0.639148</td>
      <td>0.649286</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>2.763371</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div>
<h1 id="排列和随机采样"><a class="markdownIt-Anchor" href="#排列和随机采样"></a> 排列和随机采样</h1>
<ul>
<li>
<p>使用<code>permutation()</code>函数可以实现对series或者DataFreame对象的随机排列工作。</p>
</li>
<li>
<p>先生成一个五行4列的矩阵</p>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df &#x3D; pd.DataFrame(np.arange(5 * 4).reshape(5, 4))
df</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>再生成一个随机排列的5位数组，用于按这个顺序打乱矩阵</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">sampler &#x3D; np.random.permutation(5)
sampler</code></pre>
<pre><code>array([3, 2, 0, 4, 1])
</code></pre>
<ul>
<li>按照sampler排列的顺序排列矩阵，因为sampler是随机排列的，所以实现了打乱矩阵，随机采样的效果</li>
<li><code>take()</code>函数可以实现按照特定序列实现矩阵的行调换的功能</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df.take(sampler)</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>
<ul>
<li>合并实现，并只取出3行数据</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">df.take(np.random.permutation(len(df))[:3])</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>

              </article>
          </article>
      </div>
  </div>

</div>



        </div>


        <!-- <div class="p-5 text-center ">
  <p class="h6"> <a href="https://beian.miit.gov.cn/" target="_blank">蜀ICP备2021022902号-1</a> ※ <a
          href="https://beian.mps.gov.cn/#/query/webSearch" target="_blank">川公网安备51010802032250号</a></p>
</div> -->

<div class="p-5 text-center">
  <img src="/img/beian_icon.png" alt="备案图标" class="icon" style="max-width: 48px; max-height: 48px; vertical-align: middle;">
  <p class="h6">
    <a href="https://beian.miit.gov.cn/" target="_blank">蜀ICP备2021022902号-1</a> ※
    <a href="https://beian.mps.gov.cn/#/query/webSearch" target="_blank">川公网安备51010802032250号</a>
  </p>
</div>
</body>

</html>