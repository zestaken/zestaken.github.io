<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <head>
    <link href="/styles/main.css" rel="stylesheet" type="text/css"/>

    <meta charset="UTF-8">
    
    <title>linux虚拟文件系统 - ZestJourney</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/bootstrap/4.6.1/css/bootstrap.min.css">
    <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/bootstrap/4.6.1/js/bootstrap.min.js"></script>

<script src="https://npm.elemecdn.com/@waline/client@v2/dist/waline.js"></script>
<link
  rel="stylesheet"
  href="https://npm.elemecdn.com/@waline/client@v2/dist/waline.css"
/>
<meta name="generator" content="Hexo 5.4.2"></head>

</head>

<body>
    


        <div>
            <div class="container-fluid position-relative">
                <nav class="navbar navbar-expand-lg navbar-dark  text-white bg-transparent">
                    <div class="container">
                        
                        <a class="navbar-brand" href="/">💖我们的秘密基地💖</a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText"
                            aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarText">
                            <ul class="navbar-nav mr-auto">
                            </ul>
                            <span class="navbar-text">
                                💕愿你三冬暖，愿你春不寒🍂
                            </span>
                        </div>
                    </div>
                </nav>
                <section class="lover-background"
                    style="background-image: url(/img/banner.jpg)">
                </section>
                <section
                    class="container lover-container d-flex flex-column align-content-center justify-content-center">
                    <div class="row align-items-center pb-5 lover">
                        <div class="col">
                            <div class="d-flex flex-column">
                                <img class="mx-auto avatar-img rounded-circle"
                                    src="/img/zestaken.jpg" alt="">
                                <h4 class="mx-auto text-white pt-2">  
                                    zestaken
                                </h4>
                            </div>
                        </div>
                        <div class="col">
                            <div class="d-flex justify-content-center">
                                <div class="heart"></div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="d-flex flex-column">
                                <img class="mx-auto avatar-img rounded-circle"
                                    src="/img/zinny.jpg" alt="">
                                <h4 class="mx-auto text-white pt-2">
                                    zinny
                                </h4>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="main-hero-waves-area waves-area">
                    <svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                        viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
                        <defs>
                            <path id="gentle-wave"
                                d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z">
                            </path>
                        </defs>
                        <g class="parallax">
                            <use xlink:href="#gentle-wave" x="48" y="0"></use>
                            <use xlink:href="#gentle-wave" x="48" y="3"></use>
                            <use xlink:href="#gentle-wave" x="48" y="5"></use>
                            <use xlink:href="#gentle-wave" x="48" y="7"></use>
                        </g>
                    </svg>
                </section>
            </div>

            <div id="Pjax">

  <div class="list-content mx-auto mt-5">
      <div id="article" class="list-top">
          <h5 class="list-text"> linux虚拟文件系统
          </h5>
          <article>
              <article>
                <h1 id="vfs虚拟文件系统基本概念"><a class="markdownIt-Anchor" href="#vfs虚拟文件系统基本概念"></a> VFS虚拟文件系统基本概念</h1>
<ul>
<li>VFS: Virtual File System ( Virtual Filesystem Switch)概念：
<ul>
<li><strong>逻辑文件系统(实际文件系统)</strong>  如EXT2、MINIX、MSDOS等.</li>
<li>VFS为逻辑文件系统提供<strong>统一的接口</strong>，<strong>屏蔽</strong>实际文件系统的实现细节.</li>
<li>VFS的所有数据结构在<strong>系统运行以后建立，并在卸载时删除</strong>。</li>
<li>VFS必须<strong>与实际的文件系统相接合</strong>,才能实现文件管理功能。</li>
</ul>
</li>
<li>VFS的功能：
<ul>
<li>对逻辑文件系统的<strong>数据结构进行抽象</strong>；</li>
<li>接受用户<strong>系统调用</strong> 如open, write等；</li>
<li>支持<strong>多种逻辑文件系统</strong>之间相互访问；</li>
<li>接受<strong>内核其他子系统</strong>的操作请求，特别是内存管理子系统。</li>
</ul>
</li>
<li>linux文件系统逻辑关系：<br />
<img src="https://zjpicture.oss-cn-beijing.aliyuncs.com/giteePic/picgo-master/img/20201120114340.jpg" alt="" /></li>
</ul>
<h1 id="unix文件系统"><a class="markdownIt-Anchor" href="#unix文件系统"></a> Unix文件系统</h1>
<ul>
<li>Unix文件系统采用<strong>统一命名空间</strong>，所有安装的文件系统都作为<strong>根文件系统树的枝叶</strong>出现在系统中。</li>
<li>文件通过<strong>目录</strong>组织起来，VFS将目录视为文件，可以对其进行文件的操作。
<ul>
<li>目录是一种特殊的文件。它用于创建、保持对文件系统中文件的访问路径。</li>
</ul>
</li>
<li><strong>索引节点（inode）</strong>：
<ul>
<li>文件的相关信息，被称为文件的<strong>元数据</strong>，被存储在一个单独的数据结构中，该结构被称为<strong>索引结点</strong>。</li>
<li>Inode中存放描述文件的详细信息，如文件在外存的地址等。</li>
<li>在访问装配的文件系统时，这些文件系统的inode 节点被不断的读出/写入。</li>
<li>VFS文件系统维护一个inode节点的缓存,以加速对所有装配的文件系统的访问。</li>
</ul>
</li>
<li><strong>超级块</strong>；
<ul>
<li>文件系统的<strong>控制信息</strong>存储在超级块中，超级块是一种包含文件系统信息的数据结构。</li>
</ul>
</li>
</ul>
<h1 id="vfs对象及其数据结构"><a class="markdownIt-Anchor" href="#vfs对象及其数据结构"></a> VFS对象及其数据结构</h1>
<ul>
<li>VFS使用<strong>面向对象</strong> 的设计思路，使用一组<strong>数据结构</strong>来表示通用文件对象。</li>
<li>每个主要类型中都包含一个操作对象，这个操作对象描述针对给主要对象的方法。</li>
<li>VFS中四个主要的对象类型：
<ol>
<li>超级块对象：代表一个具体的已安装的文件系统。
<ol>
<li>操作对象：super_operations对象，其中描述了<strong>内核</strong>针对特定<strong>文件系统</strong>所能调用的方法。</li>
<li>各种文件系统都<strong>必须实现超级块对象</strong>，超级块对象由<strong>super_block</strong>结构体表示，存储在&lt;linux/fs.h&gt;中。</li>
</ol>
</li>
<li>索引节点对象：代表一个具体文件。
<ol>
<li>操作对象：inode_operations对象，其中描述了<strong>内核</strong>针对特定<strong>文件</strong>所能调用的方法。</li>
<li>索引节点对象不一定在文件系统中实现，索引节点在文件被访问时才<strong>在内存中创建</strong>。</li>
<li>一个索引节点对象代表内存中的一个文件，也可以是设备或者管道这样的特殊文件。</li>
<li>索引节点由<strong>inode结构体</strong>表示，它定义在文件&lt;linux/fs.h&gt;中。</li>
</ol>
</li>
<li>目录项对象：代表一个目录项，是路径的一个组成部分。（目录项不是目录，目录是另一种形式的文件）。
<ol>
<li>操作对象：dentry_operations对象，描述<strong>内核</strong>针对特定<strong>目录</strong>所能调用的方法。</li>
<li>在路径中，**每一个部分（包括普通文件）**都是一个目录项对象。如：<code>/bin/vi</code>中，<code>/</code>,<code>bin</code>,<code>vi</code>都属于目录项对象。</li>
<li>与超级块和索引节点对象不同，目录项对象<strong>没有对应的磁盘数据结构</strong>，VFS在执行目录操作时在现场根据字符串形式的路径名创建目录项对象。</li>
<li>目录项对象由<strong>dentry结构体</strong>表示，它定义在文件&lt;linux/dentry.h&gt;中。</li>
</ol>
</li>
<li>文件对象：代表由进程已打开的文件。
<ol>
<li>操作对象：file_operations对象，描述<strong>进程</strong>针对已打开文件所能调用的方法。</li>
<li>进程<strong>直接处理的是文件</strong>，而不是超级块，目录项或者索引节点。</li>
<li>多个进程可以同时操作同一个文件，一个文件可以同时有多个文件对象。</li>
<li>类似于目录项对象，文件对象<strong>没有实际的磁盘数据结构</strong>。</li>
<li>文件对象由<strong>file结构体</strong>表示，定义在文件&lt;linux/fs.h&gt;中。</li>
</ol>
</li>
</ol>
</li>
</ul>
<h1 id="和文件系统相关的数据结构"><a class="markdownIt-Anchor" href="#和文件系统相关的数据结构"></a> 和文件系统相关的数据结构</h1>
<ul>
<li>除了以上4种VFS基础对象之外，内核还使用一些标准数据结构来管理文件系统的其它相关数据。</li>
<li><strong>file_system_type</strong>:用来描述各种特定文件系统类型，如ext3,ext4或UDF；
<ul>
<li>因为linux支持各种不同的文件系统，所以需要一个数据结构来描述各种文件系统的功能和行为。</li>
<li>file_system_type结构体被定义在文件&lt;linux/fs.h&gt;中。</li>
<li>每个文件系统对应一个file_system_type结构。</li>
</ul>
</li>
<li><strong>vfsmount</strong>:用来描述一个安装文件系统的实例；</li>
</ul>
<h1 id="和进程有关的数据结构"><a class="markdownIt-Anchor" href="#和进程有关的数据结构"></a> 和进程有关的数据结构</h1>
<ul>
<li>每一个进程都有自己的一组打开的文件。通过三个数据结构将VFS层和进程精密连接在了一起。这三个数据结构是<strong>file_struct</strong>,<strong>fs_struct</strong>,<strong>namespace</strong>.</li>
</ul>

              </article>
          </article>
      </div>
  </div>

</div>



        </div>


        <!-- <div class="p-5 text-center ">
  <p class="h6"> <a href="https://beian.miit.gov.cn/" target="_blank">蜀ICP备2021022902号-1</a> ※ <a
          href="https://beian.mps.gov.cn/#/query/webSearch" target="_blank">川公网安备51010802032250号</a></p>
</div> -->

<!-- <div class="p-5 text-center">
  <img src="/img/beian_icon.png" alt="备案图标" class="icon" style="max-width: 48px; max-height: 48px; vertical-align: middle;">
  <p class="h6">
    <a href="https://beian.miit.gov.cn/" target="_blank">蜀ICP备2021022902号-1</a> ※
    <a href="https://beian.mps.gov.cn/#/query/webSearch" target="_blank">川公网安备51010802032250号</a>
  </p>
</div> -->

<div class="p-5 text-center ">
  <p class="h6"> zestaken ❤️ zinny </p>
</div>
</body>

</html>